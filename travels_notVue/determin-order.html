<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="UTF-8">
	<script src="./js/head.meta.js"></script>
	<title>订单填写</title>
	<link rel="stylesheet" href="./css/determin-order.css">
	<link rel="stylesheet" href="//at.alicdn.com/t/font_jn5h004vsqkhuxr.css">
	<script src="./js/head.css.js"></script>
	<script src="./js/head.js.js"></script>
	<script src="./js/JMCalender.js"></script>
</head>
<body>
	<div class="head">
		<i class="iconfont icon icon-back"></i>
		<span>订单填写</span>
	</div>
	<div class="good-title">
		<p><雪山之旅>哈尔滨出发东升+雪乡+亚布力5天跟团游，通话雪乡，雪谷羊草山原始林海穿越、雾凇奇观冰雪游，含圣诞、元旦</p>
		<div class="price"><small>单价</small><span>￥<span>1380</span>起</span></div>
		<div class="clear"></div>
	</div>
	<div class="good-calerder">
		<div class="calendar-box">
            <ul class="calendar-head flex-y ">
                <li class="premon"><i class="iconfont icon icon-iconfont35"></i></li>
                <li class="curMon">2017年3月</li>
                <li class="active nextmon"><i class="iconfont icon icon-xiangyou1"></i></li>
            </ul>
            <div class="calendar-section">
                <div class="animation-box" style="height: 231px;">
                    <div class="calendar ani-transition sign-transition">
                        <div class="flex">
                            <span>日</span><span>一</span><span>二</span><span>三</span><span>四</span><span>五</span><span>六</span>
                        </div>
                        <ul id="calendar" class="calendar-all clear">

                        </ul>
                    </div>
                </div>
                <div class="clear">
            </div>
        </div>
	</div>
	<div class="order-form">
		<ul>
			<li>
				<div>成人</div>
				<div class="price"><span>￥</span><span>1050</span><span>元/人</span></div>
				<div class="count">
					<i class="iconfont icon icon-jianhao"></i>
					<div><span class="input">0</span></div>
					<i class="iconfont icon icon-jiahao"></i>
				</div>
				<div class="clear"></div>
			</li>
			<li>
				<div>儿童</div>
				<div class="price"><span>￥</span><span>1050</span><span>元/人</span></div>
				<div class="count">
					<i class="iconfont icon icon-jianhao"></i>
					<div><span class="input">0</span></div>
					<i class="iconfont icon icon-jiahao"></i>
				</div>
				<div class="clear"></div>
			</li>
			<li>
				<div>单房差</div>
				<div class="price"><span>￥</span><span>1050</span><span>元/人</span></div>
				<div class="count">
					<i class="iconfont icon icon-jianhao"></i>
					<div><span class="input">0</span></div>
					<i class="iconfont icon icon-jiahao"></i>
				</div>
				<div class="clear"></div>
			</li>
			<li class="remark-info">
				<label>备注信息：</label>
				<input type="text" placeholder="如果有其他需求请在这里输入">
			</li>
		</ul>
	</div>
	<div class="confirm-info">
		<i class="iconfont icon icon-gouxuankuang3"></i>
		<p>请在提交前确认你已经阅读<span><a href="javascript:;"  class="price-gind">费用说明</a></span></p>
	</div>
	<dic class="footer">
		<div class="total-price">订单总额：<span  class="price-num"><span>￥</span><span>3456</span></span></div>
		<div class="do-order">确认订单</div>
	</dic>
</body>
<script>
	var TDate=new Date();
	var Y=TDate.getFullYear();//年
	var mon=TDate.getMonth()+1;//月
	var lineid=I('lineid',100002);
	var month=Y+'-'+mon;
	var currentMon=mon;
	var currentMonth=Y+'-'+mon;
	var monlimit=5;//只能查当前月向后推5个月的旅游数据
	function appStart(){
		// var calenderContainer=document.getElementById('calendar');
		// var calendar=new JMCalender(calenderContainer,month);
		// calendar.init();

		getData(month);
		Endload();
		$('#calendar').on('click','li',function(){
			if($(this).hasClass('active')){
				//同步修改表单信息
				syncOrderInfo();
				$(this).removeClass('active');
			}else{
				$(this).addClass('active');
			}
			
		});
		$('.premon').on('click',function(){
			if(currentMon==mon){
				return;
			}else{
				
				if(currentMon==mon+1){
					$(this).removeClass('active');
					
				}
				currentMon-=1;
				if(currentMon!=mon+monlimit){//如果不是当月份pre按钮可点击
					if(!$('.nextmon').hasClass('active')){
						$('.nextmon').addClass('active');
					}
					
				}
				formatMonth();
				currentMonth=Y+'-'+mon;
				$('.curMon').html(Y+'年'+currentMon+'月');
				getData(currentMonth);
			}
		});
		$('.nextmon').on('click',function(){
			if(currentMon==mon+monlimit){	
				return false;
			}else{
				
				if(currentMon==mon+monlimit-1){
					$(this).removeClass('active');
				}
				currentMon+=1;
				if(currentMon!=mon){//如果不是当月份pre按钮可点击
					if(!$('.premon').hasClass('active')){
						$('.premon').addClass('active');
					}
					
				}
				formatMonth();
				currentMonth=Y+'-'+currentMon;
				$('.curMon').html(Y+'年'+currentMon+'月');
				getData(currentMonth);
			}
		});
	}
	//处理跨年的年月
	function formatMonth(){
		if(currentMon>12){
			Y=Y+1;
			currentMon=currentMon-12;
		}else if(currentMon<=0){
			Y=Y-1
			currentMon=currentMon+12;
		}
	}
	function getData(curmonth){
		ajaxJson(API.GOOD_DATE_PRICE,{'lineid':lineid,'month':curmonth},function(res){
			if(res.status==1){
				console.log(res);
				var calenderContainer=document.getElementById('calendar');
				var calendar=new JMCalender(calenderContainer,curmonth,res.data);
				calendar.init();
			}else{
				tipsLayer(res.info);
			}
		});
	}
	function syncOrderInfo(){
		
	}
</script>
</html>