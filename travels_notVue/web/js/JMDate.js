function daysBetween(e,t){var r=e.substring(5,e.lastIndexOf("-")),a=e.substring(e.length,e.lastIndexOf("-")+1),n=e.substring(0,e.indexOf("-")),s=t.substring(5,t.lastIndexOf("-")),g=t.substring(t.length,t.lastIndexOf("-")+1),i=t.substring(0,t.indexOf("-")),u=(Date.parse(r+"/"+a+"/"+n)-Date.parse(s+"/"+g+"/"+i))/864e5;return Math.abs(u)}function IsValidDate(e){var t=e.replace(/(^\s+|\s+$)/g,"");if(""==t)return!0;if(""!=t.replace(/[\d]{ 4,4 }[\-\/]{ 1 }[\d]{ 1,2 }[\-\/]{ 1 }[\d]{ 1,2 }/g,""))return!1;var r=new Date(t.replace(/\-/g,"/")),a=t.split(/[-\/:]/);return a[0]==r.getYear()&&a[1]==r.getMonth()+1&&a[2]==r.getDate()}function CheckDateTime(e){var t=e.match(/^(\d+)-(\d{ 1,2 })-(\d{ 1,2 }) (\d{ 1,2 }):(\d{ 1,2 }):(\d{ 1,2 })$/);if(null==t)return!1;t[2]=t[2]-1;var r=new Date(t[1],t[2],t[3],t[4],t[5],t[6]);return r.getFullYear()==t[1]&&(r.getMonth()==t[2]&&(r.getDate()==t[3]&&(r.getHours()==t[4]&&(r.getMinutes()==t[5]&&r.getSeconds()==t[6]))))}function StringToDate(e){var t=Date.parse(e),r=new Date(t);if(isNaN(r)){var a=e.split("-");r=new Date(a[0],--a[1],a[2])}return r}Date.prototype.Format=function(e){var t=e,r=["日","一","二","三","四","五","六"];return t=t.replace(/yyyy|YYYY/,this.getFullYear()),t=t.replace(/yy|YY/,this.getYear()%100>9?(this.getYear()%100).toString():"0"+this.getYear()%100),t=t.replace(/MM/,this.getMonth()>9?(this.getMonth()+1).toString():"0"+(this.getMonth()+1)),t=t.replace(/M/g,this.getMonth()),t=t.replace(/w|W/g,r[this.getDay()]),t=t.replace(/dd|DD/,this.getDate()>9?this.getDate().toString():"0"+this.getDate()),t=t.replace(/d|D/g,this.getDate()),t=t.replace(/hh|HH/,this.getHours()>9?this.getHours().toString():"0"+this.getHours()),t=t.replace(/h|H/g,this.getHours()),t=t.replace(/mm/,this.getMinutes()>9?this.getMinutes().toString():"0"+this.getMinutes()),t=t.replace(/m/g,this.getMinutes()),t=t.replace(/ss|SS/,this.getSeconds()>9?this.getSeconds().toString():"0"+this.getSeconds()),t=t.replace(/s|S/g,this.getSeconds())},Date.prototype.DateAdd=function(e,t){var r=this;switch(e){case"s":return new Date(Date.parse(r)+1e3*t);case"n":return new Date(Date.parse(r)+6e4*t);case"h":return new Date(Date.parse(r)+36e5*t);case"d":return new Date(Date.parse(r)+864e5*t);case"w":return new Date(Date.parse(r)+6048e5*t);case"q":return new Date(r.getFullYear(),r.getMonth()+3*t,r.getDate(),r.getHours(),r.getMinutes(),r.getSeconds());case"m":return new Date(r.getFullYear(),r.getMonth()+t,r.getDate(),r.getHours(),r.getMinutes(),r.getSeconds());case"y":return new Date(r.getFullYear()+t,r.getMonth(),r.getDate(),r.getHours(),r.getMinutes(),r.getSeconds())}},Date.prototype.DateDiff=function(e,t){var r=this;switch("string"==typeof t&&(t=StringToDate(t)),e){case"s":return parseInt((t-r)/1e3);case"n":return parseInt((t-r)/6e4);case"h":return parseInt((t-r)/36e5);case"d":return parseInt((t-r)/864e5);case"w":return parseInt((t-r)/6048e5);case"m":return t.getMonth()+1+12*(t.getFullYear()-r.getFullYear())-(r.getMonth()+1);case"y":return t.getFullYear()-r.getFullYear()}},Date.prototype.toString=function(e){var t=this,r=t.toLocaleDateString();if(e){r+=" 星期"+["日","一","二","三","四","五","六"][t.getDay()]}return r},Date.prototype.toArray=function(){var e=this,t=Array();return t[0]=e.getFullYear(),t[1]=e.getMonth(),t[2]=e.getDate(),t[3]=e.getHours(),t[4]=e.getMinutes(),t[5]=e.getSeconds(),t},Date.prototype.DatePart=function(e){var t=this,r="",a=["日","一","二","三","四","五","六"];switch(e){case"y":r=t.getFullYear();break;case"m":r=t.getMonth()+1;break;case"d":r=t.getDate();break;case"w":r=a[t.getDay()];break;case"ww":r=t.WeekNumOfYear();break;case"h":r=t.getHours();break;case"n":r=t.getMinutes();break;case"s":r=t.getSeconds()}return r},Date.prototype.MaxDayOfDate=function(){var e=this,t=e.toArray(),r=new Date(t[0],t[1]+1,1),a=r.dateAdd(1,"m",1);return dateDiff(r.Format("yyyy-MM-dd"),a.Format("yyyy-MM-dd"))},Date.prototype.WeekNumOfYear=function(){var e=this,t=e.toArray();t[0],t[1],t[2];return document.write("< script language=VBScript> \n"),document.write("myDate = Datue(''+month+'-'+day+'-'+year+'') \n"),document.write("result = DatePart('ww', myDate) \n"),document.write(" \n"),result};